Please note that this mitigation disables ptrace functionality whichdebuggers and programs that inspect other processes (virus scanners)use and thus these programs won't be operational.Also this mitigation works against the In The Wild (ITW) exploit we are aware of but most likely does not mitigate the issue as a whole.To mitigate the issue:1) On the host, save the following in a file with the ".stp" extension:probe kernel.function("mem_write").call ? {        $count = 0}probe syscall.ptrace {  // includes compat ptrace as well        $request = 0xfff}probe begin {        printk(0, "CVE-2016-5195 mitigation loaded")}probe end {        printk(0, "CVE-2016-5195 mitigation unloaded")}2) Install the "systemtap" package and any required dependencies. Referto the "2. Using SystemTap" chapter in the Red Hat Enterprise Linux"SystemTap Beginners Guide" document, available from docs.redhat.com,for information on installing the required -debuginfo packages.3) Run the "stap -g [filename-from-step-1].stp" command as root.If the host is rebooted, the changes will be lost and the script must berun again.Alternatively, build the systemtap script on a development system with"stap -g -p 4 [filename-from-step-1].stp", distribute the resultingkernel module to all affected systems, and run "staprun -L <module>" on those.When using this approach only systemtap-runtime package is required onthe affected systems. Please notice that the kernel version must be the sameacross all systems.
